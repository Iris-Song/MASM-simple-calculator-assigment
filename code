DATA SEGMENT
WCMSTR DB 0AH,0DH,"Please input a simple expression(only contain +,-,*,\)",'$'
OUTSTR DB 0AH,0DH,"The result is",'$'
ERRSTR DB 0AH,0DH,"error",'$'
DATA ENDS

CODE SEGMENT
MAIN PROC
    ASSUME CS:CODE, DS:DATA
    MOV  AX, DATA
    MOV  DS, AX  
    LEA  DX,WCMSTR
    MOV  AX,9
    INT  21H        ;输出提示信息
    MOV  AH,1
 AGAIN:
    INT  21H        ;输入一个字符
    CMP  AL,0DH
    JE   EXIT       ;如果是回车，就退出该程序
    CMP  AL,'+'
    JE   ADDITION
    CMP  AL,'-'
    JE   SUBTRACTION
    CMP  AL,'*'
    JE   MULTIPLY  
    CMP  AL,'/'
    JE   DIVISION
    CMP  AL,'0'
    JG   ERROR
    CMP  AL,'9'
    JL   ERROR
    SUB  30H
    MOV  CL,10
    MUL  CL
    ADD  DX,AX
    JMP  AGAIN
    CALL OUTPUT    
EXIT:
    MOV  AX, 4C00H
    INT  21H
ERROR:
    LEA  DX,ERRSTR
    MOV  AX,9
    INT  21H
    JMP  EXIT
    
OUTPUT PROC
    MOV CX,1         ;计数 初始为1
    MOV BL,10;每次除10
ONE:
    MOV AH,0;清零（存余数）
    MOV AL,DL
    DIV BL;除10
    PUSH AX;进栈
    CMP AL,0;是否已除净
    JLE ENDL
    MOV DL,AL
    INC CX
    JMP ONE
ENDL:
    POP DX
    XCHG DH,DL;余数转入DL
    ADD DL,30H
    MOV AH,2;输出
    INT 21H
    LOOP ENDL
    RET
END OUTPUT
CODE ENDS
END MAIN
